---
title: "Milestone #4"
author: "Gayatri Balasubramanian"
date: "10/10/2019"
output: html_document
---

```{r setup, include=FALSE}

# default settings

knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE, fig.width=7, fig.height=4)


# download libraries we need

library(janitor)
library(tidyverse)

```

### Problem statement

How does Census data on geographic distribution of ethnicity by county in Indiana related to the distribution of industry in Indiana?

### Graph and Progress

This week I went through my data and cleaned it up. It was a lot to clean up, but now I have every county and every subdivision of race provided by census reporter. I also decided to focus on the races: black, white, asian, native american, hispanic, and to leave out pacific islanders.


```{r first_plot}

# read table for all races

combined_race  <- read_csv("raw-data/all_races.csv") %>%
  clean_names()


# filter data for hamilton county only

hamilton_county <- combined_race %>% 
  select(ethnicity, race, hamilton_county_in) %>% 
  filter(hamilton_county_in != 0, race != "White") %>% 
  arrange(desc(hamilton_county_in))


# filter data for tippecanoe  county

tippecanoe_county_in <- combined_race %>% 
  select(ethnicity, race, tippecanoe_county_in) %>% 
  filter(tippecanoe_county_in != 0, race != "White") %>% 
  arrange(desc(tippecanoe_county_in))


# filter data for brown county

brown_county_in <- combined_race %>% 
  select(ethnicity, race, brown_county_in) %>% 
  filter(brown_county_in != 0, race != "White") %>% 
  arrange(desc(brown_county_in))


# filter data for lake county

lake_county_in <- combined_race %>% 
  select(ethnicity, race, lake_county_in) %>% 
  filter(lake_county_in != 0, race != "White") %>% 
  arrange(desc(lake_county_in))


# filter data for vigo county

vigo_county_in <- combined_race %>% 
  select(ethnicity, race, vigo_county_in) %>% 
  filter(vigo_county_in != 0, race != "White") %>% 
  arrange(desc(vigo_county_in))


# plot for each county

# hamilton county ethnicity plot

hamilton_county %>% 
  ggplot(aes(x = reorder(ethnicity, hamilton_county_in), y = hamilton_county_in, fill = race)) + 
  geom_col() +
  theme(
    strip.background = element_blank(),
    strip.placement = "outside", 
    axis.text.x = element_text(angle = 90, size = 7, vjust=0.2)
  ) +
  labs(
    title = "Non-White Race in Hamilton County, Indiana",
    subtitle = "Data from Census Reporter",
    x = "Ethnicity",
    y = "Population"
  )


# tippecanoe county ethnicity plot

tippecanoe_county_in %>% 
  ggplot(aes(x = reorder(ethnicity, tippecanoe_county_in), y = tippecanoe_county_in, fill = race)) + 
  geom_col() +
  theme(
    strip.background = element_blank(),
    strip.placement = "outside", 
    axis.text.x = element_text(angle = 90, size = 7, vjust=0.2)
  ) +
  labs(
    title = "Non-White Race in Tippecanoe County, Indiana",
    subtitle = "Data from Census Reporter",
    x = "Ethnicity",
    y = "Population"
  )


# brown county ethnicity plot

brown_county_in %>% 
  ggplot(aes(x = reorder(ethnicity, brown_county_in), y = brown_county_in, fill = race)) + 
  geom_col() +
  theme(
    strip.background = element_blank(),
    strip.placement = "outside", 
    axis.text.x = element_text(angle = 90, size = 7, vjust=0.2)
  ) +
  labs(
    title = "Non-White Race in Brown County, Indiana",
    subtitle = "Data from Census Reporter",
    x = "Ethnicity",
    y = "Population"
  )


# lake county ethnicity plot

lake_county_in %>% 
  ggplot(aes(x = reorder(ethnicity, lake_county_in), y = lake_county_in, fill = race)) + 
  geom_col() +
  theme(
    strip.background = element_blank(),
    strip.placement = "outside", 
    axis.text.x = element_text(angle = 90, size = 7, vjust=0.2)
  ) +
  labs(
    title = "Non-White Race in Lake County, Indiana",
    subtitle = "Data from Census Reporter",
    x = "Ethnicity",
    y = "Population"
  )


# vigo county ethnicity plot

vigo_county_in %>% 
  ggplot(aes(x = reorder(ethnicity, vigo_county_in), y = vigo_county_in, fill = race)) + 
  geom_col() +
  theme(
    strip.background = element_blank(),
    strip.placement = "outside", 
    axis.text.x = element_text(angle = 90, size = 7, vjust=0.2)
  ) +
  labs(
    title = "Non-White Race in Vigo County, Indiana",
    subtitle = "Data from Census Reporter",
    x = "Ethnicity",
    y = "Population"
  )

```